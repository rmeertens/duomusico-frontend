<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    
    <title>Portfolio Item - Start Bootstrap Template</title>
 <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
        var test;

        function clearData() {
            a = document.getElementById("test1");
            a.innerHTML = "";
        }
        
        function getDivArtistSongRating(nameAndArtist, index, mustDisplayScore)
        {
            
            // "<div class=\"col-sm-6 col-md-4\">\
            var toFill = "<div class=\"col-sm-6 col-md-4 myclass\" >\
                            <div class=\"thumbnail\" height: 648px>\
                            <div class=\"caption\">\
                            <h3><span class=\"glyphicon glyphicon-user\" aria-hidden=\"true\"></span>   "+nameAndArtist.Artist+"</h3>\
                            <h3><span class=\"glyphicon glyphicon-music\" aria-hidden=\"true\"></span>  "+nameAndArtist.NameSong+"</h3>";
            if(mustDisplayScore)
            {
                toFill += "<h3><span class=\"glyphicon glyphicon-dashboard\" aria-hidden=\"true\"></span>  "+ nameAndArtist.Score+" percent</h3>";
            }
            toFill += "      </div>\
                            <div id=\"spotify"+index+"\"></div>\
                            </div>\
                            </div>";
            return toFill;
   
        }
        
        function placeResults(results, mustDisplayScore)
        {
            for (var index = 0; index < results.length; index++) {
                var nameAndArtist = results[index];
                var toAdd = getDivArtistSongRating(nameAndArtist,index, mustDisplayScore);
                a = document.getElementById("test1");
                a.innerHTML = a.innerHTML + toAdd;
                searchAlbums(nameAndArtist.NameSong + " " + nameAndArtist.Artist,index);
            }   
        }
        function myFunction() {
            //document.getElementById("loading").style.display = "";
            clearData();
            $.ajax({
                type: "GET",
                url: "http://80.60.177.158:8002/duolingorecommendation?username=" + document.getElementById("id_of_textbox").value+"&random=false",
                contentType: "application/json; charset=UTF-8",
                dataType: "json",
                
                success: function(results) {
                    
                    console.log("Done with getting a response in the new thing");
                    console.log(results);
                    test = results;
                    placeResults(results, true);
                    $("#getRandomSongsButton").show();  
                    
            },
            error: function (xhr, textStatus, errorThrown) {
                $("#error").html(xhr.responseText);
            }
        });
        }
        
        function getRandomSongs() {
            clearData();
            $.ajax({
                type: "GET",
                url: "http://80.60.177.158:8002/duolingorecommendation?username=" + document.getElementById("id_of_textbox").value+"&random=true",
                contentType: "application/json; charset=UTF-8",
                dataType: "json",
                
                success: function(results) {
                    
                    console.log("Done with getting a response with random songs");
                    console.log(results);
                    test = results;
                    placeResults(results, true);
                    
            },
            error: function (xhr, textStatus, errorThrown) {
                $("#error").html(xhr.responseText);
            }
        });
        }
        
        function getRandomSongsInLanguage(language) {
            clearData();
            $.ajax({
                type: "GET",
                url: "http://80.60.177.158:8002/randomSong?langage="+language,
                
                contentType: "application/json; charset=UTF-8",
                dataType: "json",
                
                success: function(results) {
                    
                    console.log("Done with getting a response with random songs");
                    console.log(results);
                    test = results;
                    placeResults(results, true);
                    
            },
            error: function (xhr, textStatus, errorThrown) {
                $("#error").html(xhr.responseText);
            }
        });
        }
            
          
      var searchAlbums = function(query, index) {
            $.ajax({
                url: 'https://api.spotify.com/v1/search',
                data: {
                    q: query,
                    type: 'track'
                },
                success: function(response) {
                    console.log("Response is: ");
                    console.log(response);

                    console.log("Element is: ");
                    console.log(index);
                    if(response.tracks.items.length>0)
                    {
                        document.getElementById("spotify" + index).innerHTML = "<iframe src=\"https://embed.spotify.com/?uri=spotify:track:" + response.tracks.items[0].id + "\" width=\"300\" height=\"380\" frameborder=\"0\" allowtransparency=\"true\"></iframe>";    
                    }
                    else
                    {
                         document.getElementById("spotify" + index).innerHTML = "<img src=\"notfound.png\" alt=\"Oh no..\" style= \"width:300px;height:380px\">"
                    }
                }
            });
        };
    </script>
    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Flags -->
    <link href="./css/flag-icon.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/portfolio-item.css" rel="stylesheet">
    
    
    <STYLE type="text/css">
        div.myclass {min-width: 350px}
        div.thumbnail{height: 648px}
        
    </STYLE>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->

    <!-- Page Content -->
    <div class="container">

        <!-- Portfolio Item Heading -->
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Duolingo e-mersion
                    <small>Using artifical intelligence to select songs when learning a new language</small>
                </h1>
            </div>
        </div>
        <!-- /.row -->

        <!-- Portfolio Item Row -->
        <div class="row">
            <div>
                <h3>What to listen</h3>
                <p>You want to hear songs based on what words you know... fill in your Duolingo username here:</p>
              
            <input type="text" name="id_of_textbox" value="rmeertens" id="id_of_textbox"><button onclick="myFunction()">Best songs</button><button onclick="getRandomSongs()" id="getRandomSongsButton" hidden="true">Random songs</button>
            </div>
            
            <div>
                <h3>What do the icons mean?</h3>
                <h5><span class="glyphicon glyphicon-user" aria-hidden="true"></span>   Artist name</h5>
                <h5><span class="glyphicon glyphicon-music" aria-hidden="true"></span>  Song name</h5>
            <h5><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> The percentage of words you know</h5>
            </div>

        </div>
        <!-- /.row -->
        <div id="test1"></div>
        <!-- Related Projects Row -->

        <div class="container">
      <section id="examples">
        <div class="page-header">
          <h1>Get random music in a specific language</h1>
        </div>
        <div class="no-wrap">
          <h1>
            
              <span class="label label-primary"><span class="flag-icon flag-icon-fr"></span>French</span>
               <span class="label label-primary"><span class="flag-icon flag-icon-se"></span>Swedish</span>
              <span class="label label-primary"><span class="flag-icon flag-icon-us"></span>English</span>
          </h1>
        </section>
      </section>     
    </div>
    <footer class="footer">
      <div class="container">
        </div>
        
        <div class="row featurette">
        <div class="col-md-7">
          <h2 class="featurette-heading">Contact me </h2>
          Do you have any questions? Want to help with beta testing? Can you contribute code? Should we clearly add this one songtext?
            Send a mail to rolandmeertens@gmail.com
        </div>

      </div>
        
    
    </footer>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>
    <script>
   // document.getElementById("loading").style.display = "none";
</script>

</html>
